package stdioImporter.runtime;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNode;
import stdio_parser.CodeGenerator;
import stdio_parser.var_decl;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;

public class Importer {
  public static boolean doImport(SNode module, String filename) {
    try {
      CodeGenerator cg = ParserAdapter.Parse(filename);
      Typer typer = new Typer();
      for (var_decl v : ListSequence.fromList(cg.getVars())) {
        SNode gvd = SConceptOperations.createNewNode("com.mbeddr.core.modules.structure.GlobalVariableDeclaration", null);
        SLinkOperations.setTarget(gvd, "type", typer.buildType(v.getType(), null), true);
        SPropertyOperations.set(gvd, "name", v.getID());
        SNode cm = SConceptOperations.createNewNode("com.mbeddr.core.modules.structure.CommentModuleContent", null);
        SPropertyOperations.set(cm, "comment", "[" + v.getID() + "] --> [" + v.getType() + "]");
        ListSequence.fromList(SLinkOperations.getTargets(module, "contents", true)).addElement(gvd);
        ListSequence.fromList(SLinkOperations.getTargets(module, "contents", true)).addElement(cm);

      }


    } catch (Exception e) {
      return false;
    }
    return true;
  }
}
